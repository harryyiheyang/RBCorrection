% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MRcML_BBC.R
\name{MRcML_BBC}
\alias{MRcML_BBC}
\title{MRcML with background bias correction (BBC).}
\usage{
MRcML_BBC(
  by,
  bX,
  byse,
  bXse,
  gcov,
  ldsc,
  cov_RB,
  max.iter = 30,
  max.eps = 1e-05,
  lambda = 3,
  a = 3,
  sampling.time = 300,
  n_threads = 4,
  max.prop.pleio = 0.5,
  sampling.strategy = "subsampling"
)
}
\arguments{
\item{by}{A vector (n x 1) of the GWAS effect sizes of the outcome
after Rao–Blackwell correction.}

\item{bX}{A matrix (n x p) of the GWAS effect sizes of p exposures
after Rao–Blackwell correction. If univariable, \code{bX} can be a
vector of length n, in which case \code{MRcML_BBC} calls
\code{MRcML_UV_BBC} internally.}

\item{byse}{A vector (n x 1) of the standard errors of \code{by}
after Rao–Blackwell correction.}

\item{bXse}{A matrix (n x p) of the standard errors of \code{bX}
after Rao–Blackwell correction. If univariable, \code{bXse} can be
a vector of length n.}

\item{gcov}{A ((p+1) x (p+1)) matrix of the per-SNP genetic covariance
of the p exposures and the outcome. The last row/column corresponds
to the outcome.}

\item{ldsc}{A vector (n x 1) of LD scores of the instruments.}

\item{cov_RB}{A list of length n, where each element is a ((p+1) x (p+1))
matrix of Rao–Blackwell correction terms for the joint
(exposures, outcome) GWAS estimates at a given SNP.}

\item{max.iter}{Maximum number of iterations for causal effect estimation.
Defaults to 30.}

\item{max.eps}{Tolerance for the stopping criterion based on the change
in the causal effect estimates. Defaults to 1e-5.}

\item{lambda}{Tuning parameter for the MCP loss used to downweight
outlying instruments. Defaults to 3.}

\item{a}{Concavity parameter of the MCP loss (often denoted gamma in the
MCP literature). Must be greater than 1. Defaults to 5.}

\item{sampling.time}{Number of bootstrap iterations used to estimate the
covariance of the causal effect estimates. Defaults to 300.}

\item{n_threads}{Number of threads used in the internal C++ routines.
Defaults to 4.}

\item{max.prop.pleio}{A numeric value in (0, 1) giving the maximum allowed
proportion of non-zero pleiotropic terms. Instruments beyond this
proportion are truncated by \code{pleio_adj}. Default is 0.5.}

\item{sampling.strategy}{Character string indicating the resampling
strategy, either \code{"bootstrap"} (sampling with replacement) or
\code{"subsampling"} (using 50\% of the instruments without replacement).}
}
\value{
A list containing:
\describe{
  \item{theta}{A vector (length p) of the estimated causal effects of
    the exposures on the outcome.}
  \item{theta.cov}{A (p x p) covariance matrix of \code{theta} obtained
    from the bootstrap samples.}
  \item{theta.se}{A vector (length p) of the standard errors of
    \code{theta}.}
  \item{gamma}{A vector (length n) of the estimated pleiotropic or
    background bias terms for each SNP.}
  \item{theta.bootstrap}{A (sampling.time x p) matrix of bootstrap
    estimates of \code{theta}.}
}

For univariable input (when \code{bX} is a vector), \code{MRcML_BBC}
calls \code{MRcML_UV_BBC} internally and returns its output.
}
\description{
This function estimates multivariable causal effects using an MRcML-type
likelihood method combined with background bias correction (BBC).
It uses an MCP-based loss to downweight outlying instruments and
accounts for sample overlap through LDSC and Rao–Blackwell corrections
applied to both exposure and outcome GWAS estimates.
}
