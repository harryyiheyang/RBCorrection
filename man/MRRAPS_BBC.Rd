% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MRRAPS_BBC.R
\name{MRRAPS_BBC}
\alias{MRRAPS_BBC}
\title{Univariable GRAPPLE with background bias correction (BBC)}
\usage{
MRRAPS_BBC(
  by,
  bx,
  byse,
  bxse,
  cov_RB,
  gcov = diag(2) * 0,
  ldsc = rep(0, length(by)),
  max.iter = 100,
  max.eps = 1e-06,
  lambda = 3,
  a = 3,
  tau_upper = 10,
  sampling.time = 300,
  n_threads = 4,
  max.prop.pleio = 0.5,
  sampling.strategy = "subsampling"
)
}
\arguments{
\item{by}{A numeric vector (m x 1) of GWAS effect sizes for the outcome
yielded by Rao-Blackwell correction.}

\item{bx}{A numeric vector (m x 1) of GWAS effect sizes for the exposure
yielded by Rao-Blackwell correction.}

\item{byse}{A numeric vector (m x 1) of standard errors for \code{by}
yielded by Rao-Blackwell correction.}

\item{bxse}{A numeric vector (m x 1) of standard errors for \code{bx}
yielded by Rao-Blackwell correction.}

\item{cov_RB}{A list of m matrices of Rao-Blackwell correction terms,
each of dimension 2 x 2.}

\item{gcov}{A 2 x 2 matrix of the per-SNP genetic covariance between the
exposure and the outcome. The second row/column should correspond to
the outcome. Default is a 2 x 2 zero matrix.}

\item{ldsc}{A numeric vector (m x 1) of LD scores of the instruments.}

\item{max.iter}{Maximum number of iterations for updating the causal
effect. Default is 30.}

\item{max.eps}{Tolerance for the stopping criterion based on the change
in the causal effect estimate. Default is 1e-4.}

\item{lambda}{Tuning parameter for the MCP loss used to downweight
large residuals. Default is 2.}

\item{a}{Concavity parameter for the MCP loss (often denoted gamma in
the MCP literature). Must be greater than 1. Default is 3.}

\item{tau_upper}{Upper bound of the search range for the variance
inflation parameter \code{tau} in the robust variance equation.
Default is 10.}

\item{sampling.time}{Number of bootstrap iterations used to estimate the
variance of the causal effect. Default is 300.}

\item{n_threads}{The number of threads. Defaults to 4.}

\item{max.prop.pleio}{A numeric value in (0, 1). The maximum allowed proportion  of non-zero pleiotropic terms. Default is 0.5.}

\item{sampling.strategy}{"bootstrap" or "subsampling" (0.5 sample without replacement).}
}
\value{
A list with the following components:
\item{theta}{Estimated causal effect.}
\item{theta.var}{Estimated variance of \code{theta} based on the bootstrap.}
\item{theta.se}{Standard error of \code{theta}, computed as
  \code{sqrt(theta.var)}.}
\item{gamma}{Estimated pleiotropic or background bias term for each SNP.}
\item{theta.bootstrap}{A numeric vector of length \code{sampling.time}
  containing bootstrap estimates of \code{theta}.}
}
\description{
This function estimates the univariable causal effect using a GRAPPLE-type
likelihood method with background bias correction (BBC). It uses
an MCP-based loss to downweight outlying instruments and incorporates
LDSC and Rao-Blackwell corrections to improve stability under weak and
biased instruments.
}
