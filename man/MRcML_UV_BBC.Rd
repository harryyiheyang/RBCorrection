% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MRcML_UV_BBC.R
\name{MRcML_UV_BBC}
\alias{MRcML_UV_BBC}
\title{Univariable MRcML with background bias correction (BBC).}
\usage{
MRcML_UV_BBC(
  by,
  bx,
  byse,
  bxse,
  gcov = diag(2) * 0,
  ldsc = rep(0, length(by)),
  cov_RB,
  max.iter = 50,
  max.eps = 1e-06,
  lambda = 3,
  a = 3,
  sampling.time = 300,
  n_threads = 4,
  max.prop.pleio = 0.5,
  sampling.strategy = "subsampling"
)
}
\arguments{
\item{by}{A numeric vector (m x 1) of GWAS effect sizes for the outcome
after Rao–Blackwell correction.}

\item{bx}{A numeric vector (m x 1) of GWAS effect sizes for the exposure
after Rao–Blackwell correction.}

\item{byse}{A numeric vector (m x 1) of standard errors for \code{by}
after Rao–Blackwell correction.}

\item{bxse}{A numeric vector (m x 1) of standard errors for \code{bx}
after Rao–Blackwell correction.}

\item{gcov}{A 2 x 2 matrix of the per-SNP genetic covariance between the
exposure and the outcome. The second row/column should correspond to
the outcome.}

\item{ldsc}{A numeric vector (m x 1) of LD scores of the instruments.}

\item{cov_RB}{A list of length m, where each element is a 2 x 2 matrix of
Rao–Blackwell correction terms for the joint (exposure, outcome)
GWAS estimates at a given SNP.}

\item{max.iter}{Maximum number of iterations for updating the causal
effect. Default is 30.}

\item{max.eps}{Tolerance for the stopping criterion based on the change
in the causal effect estimate. Default is 1e-5.}

\item{lambda}{Tuning parameter for the MCP loss used to downweight
large residuals. Default is 3.}

\item{a}{Concavity parameter for the MCP loss (often denoted gamma in
the MCP literature). Must be greater than 1. Default is 5.}

\item{sampling.time}{Number of bootstrap iterations used to estimate the
variance of the causal effect. Default is 300.}

\item{n_threads}{Number of threads used in the internal C++ routines.
Defaults to 4.}

\item{max.prop.pleio}{A numeric value in (0, 1) giving the maximum allowed
proportion of non-zero pleiotropic terms. Default is 0.5.}

\item{sampling.strategy}{Character string indicating the resampling
strategy, either \code{"bootstrap"} (sampling with replacement) or
\code{"subsampling"} (using 50\% of the instruments without replacement).}
}
\value{
A list with the following components:
\item{theta}{Estimated causal effect.}
\item{theta.var}{Estimated variance of \code{theta} based on the bootstrap.}
\item{theta.se}{Standard error of \code{theta}, computed as
  \code{sqrt(theta.var)}.}
\item{gamma}{Estimated pleiotropic or background bias term for each SNP.}
\item{theta.bootstrap}{A numeric vector of length \code{sampling.time}
  containing bootstrap estimates of \code{theta}.}
}
\description{
This function estimates the univariable causal effect using an MRcML-type
likelihood method with background bias correction (BBC). It uses
an MCP-based loss to downweight outlying instruments and incorporates
LDSC and Rao–Blackwell corrections to improve stability under weak and
biased instruments.
}
