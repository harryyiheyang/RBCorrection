% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Grapple_BBC.R
\name{GRAPPLE_BBC}
\alias{GRAPPLE_BBC}
\title{GRAPPLE with background bias correction (BBC).}
\usage{
GRAPPLE_BBC(
  by,
  bX,
  byse,
  bXse,
  gcov,
  ldsc,
  cov_RB,
  max.iter = 30,
  max.eps = 1e-05,
  lambda = 3,
  a = 3,
  tau_upper = 10,
  sampling.time = 300,
  n_threads = 4,
  max.prop.pleio = 0.5,
  sampling.strategy = "subsampling"
)
}
\arguments{
\item{by}{A vector (n x 1) of the GWAS effect sizes of the outcome
after Rao-Blackwell correction.}

\item{bX}{A matrix (n x p) of the GWAS effect sizes of p exposures
after Rao-Blackwell correction. If univariable, \code{bX} can be a vector
of length n.}

\item{byse}{A vector (n x 1) of the standard errors of \code{by}
after Rao-Blackwell correction.}

\item{bXse}{A matrix (n x p) of the standard errors of \code{bX}
after Rao-Blackwell correction. If univariable, \code{bXse} can be a
vector of length n.}

\item{gcov}{A matrix ((p+1) x (p+1)) of the per-SNP genetic covariance
of the p exposures and the outcome. The last row/column corresponds
to the outcome.}

\item{ldsc}{A vector (n x 1) of LD scores of the instruments.}

\item{cov_RB}{A list of length n, where each element is a (p+1 x p+1)
matrix of Rao-Blackwell correction terms for the joint
(exposures, outcome) GWAS estimates at a given SNP.}

\item{max.iter}{Maximum number of iterations for causal effect estimation.
Defaults to 30.}

\item{max.eps}{Tolerance for the stopping criterion based on the change
in the causal effect estimates. Defaults to 1e-4.}

\item{lambda}{Tuning parameter for the MCP loss used to downweight outliers.
Defaults to 2.}

\item{a}{Concavity parameter of the MCP loss (often denoted gamma in the
MCP literature). Must be greater than 1. Defaults to 3.}

\item{tau_upper}{Upper bound of the search range for the variance
inflation parameter \code{tau} in the robust variance equation.
Defaults to 10.}

\item{sampling.time}{Number of bootstrap iterations used to estimate the
covariance (or variance) of the causal effect estimates. Defaults to 300.}

\item{n_threads}{The number of threads. Defaults to 4.}

\item{max.prop.pleio}{A numeric value in (0, 1). The maximum allowed proportion  of non-zero pleiotropic terms. Default is 0.5.}

\item{sampling.strategy}{"bootstrap" or "subsampling" (0.5 sample without replacement).}
}
\value{
A list containing:
\describe{
  \item{theta}{A vector (length p) of the estimated causal effects of
    the exposures on the outcome.}
  \item{theta.cov}{A (p x p) covariance matrix of \code{theta} obtained
    from the bootstrap samples (for multivariable input).}
  \item{theta.se}{A vector (length p) of the standard errors of
    \code{theta}.}
  \item{gamma}{A vector (length n) of the estimated pleiotropy or
    background bias terms for each SNP.}
  \item{theta.bootstrap}{A (sampling.time x p) matrix of bootstrap
    estimates of \code{theta}.}
}

For univariable input (when \code{bX} is a vector), \code{Grapple_BBC}
calls \code{MRRAPS_BBC} internally and returns its output (scalar effect,
variance, standard error, pleiotropy term, and bootstrap replicates).
}
\description{
This function estimates causal effects using a robust GRAPPLE-type
likelihood method combined with background bias correction (BBC).
It uses an MCP-based loss to downweight outlying instruments and
accounts for sample overlap through LDSC and Rao-Blackwell corrections.
}
